/*
 * mainseqn - Generic main for trace-sequential application programs
 *		when the output is not SU data
 */

#include "../include/su.h"

int xargc;				/* THIS EXTERNALS ARE ESSENTIAL */
char *sdoc,**xargv;			/* TO LINK THIS MODULE TO THE */
bool verbose;				/* SU LIBRARY */

main(ac,av)
int ac; char **av;
{
	int infd,itr;
	Sutrace tr;
	Subhed bh;

	xargc = ac; xargv = av;		/* INITIALIZE COMMAND LINE EXTERNALS */

	initsdoc();			/* INITIALIZE SELF DOCUMENTATION */

	optpars();			/* OPTIONS AND PARAMETERS */

	infd = input();			/* OPEN FILES */

	apass(infd,-1);			/* READ ASCII HEADER */

	getbh(infd,&bh);		/* READ BINARY HEADER */

					/* DYNAMIC TRACE MEMORY ALLOCATION */
	tr.data = (float*) malloc(bh.ns*bh.esize);

	itr = 0;			/* MAIN LOOP */
	while (gettr(infd,&tr)) {	/* AS LONG AS THERE ARE DATA */

		trseqn(itr++,&tr,&bh);	/* TRACE PROCESSING */
	}


	postp();			/* POST PROCESSING */

	exit(0);
}

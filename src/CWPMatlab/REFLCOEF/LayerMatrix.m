%=============================================================================
% Construct diagonal layer matrix 
%=============================================================================

function L = LayerMatrix(w, z, p3) 

%=============================================================================

% Calculate exponents 
for iq=1:3
   v(iq) = exp(i*w*p3(iq)*z);
   v(iq+3) = 1/v(iq);
end;

L = diag(v);

%=============================================================================


%==============================================================================
% Compute Vnmo at a number of azimuths using the NMO ellipse 
% W = [W11, W12, W22]
%==============================================================================

function Vnmo = compVnmo(W);

%==============================================================================

for iaz=1:3
  alpha = (iaz-1)*pi/3;
  ala = W(1)*(cos(alpha))^2;
  alb = W(2)*(sin(2*alpha));
  alc = W(3)*(sin(alpha))^2; 
  if ala+alb+alc > 0
    Vnmo(iaz) = 1/sqrt(ala+alb+alc);
  else
    Vnmo(iaz) = -1;
  end;
end;

%==============================================================================

